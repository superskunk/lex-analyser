                                                                                                                                                                                                                                                       ┌─┐ 
                                                                                                                                                                                                                                                       ║"│ 
                                                                                                                                                                                                                                                       └┬┘ 
                                                                                                                                                                                                                                                       ┌┼┐ 
                         ┌──┐                                   ┌──┐                                  ┌────┐                             ┌───┐                                         ┌────┐                              ┌──────────┐                 │  
                         │RP│                                   │OP│                                  │MSSP│                             │OTA│                                         │SMSC│                              │SIM Applet│                ┌┴┐ 
                         └┬─┘                                   └┬─┘                                  └─┬──┘                             └─┬─┘                                         └─┬──┘                              └────┬─────┘               User 
                          │        1.. POST /bc-authorize        │                                      │                                  │                                             │                                      │                      │   
                          │ ─────────────────────────────────────>                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
  ╔═══════════════════════╧══════════════════════════════════════╧══════════════════════════╗           │                                  │                                             │                                      │                      │   
  ║{                                                                                        ║           │                                  │                                             │                                      │                      │   
  ║             "scope": "openid",                                                          ║           │                                  │                                             │                                      │                      │   
  ║             "client_req_id": "8d67dc78-7faa-4d41-aabd-67707b374255",                    ║           │                                  │                                             │                                      │                      │   
  ║             "client_notification_endpoint": "https://client.example.com/cb",            ║           │                                  │                                             │                                      │                      │   
  ║             "acr_values": "mod-mf",                                                     ║           │                                  │                                             │                                      │                      │   
  ║             "login_hint_token": "eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ......"  ║           │                                  │                                             │                                      │                      │   
  ║            }                                                                            ║           │                                  │                                             │                                      │                      │   
  ╚═══════════════════════╤══════════════════════════════════════╤══════════════════════════╝           │                                  │                                             │                                      │                      │   
                          │            2. HTTP 200 OK            │                                      │                                  │                                             │                                      │                      │   
                          │ <─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                      ╔═══╧══════════════════════════════════════╧═════╗                                │                                  │                                             │                                      │                      │   
                      ║{"auth_req_id"=40582304823, "expires_in"=3600}  ║                                │                                  │                                             │                                      │                      │   
                      ╚═══╤══════════════════════════════════════╤═════╝                                │                                  │                                             │                                      │                      │   
                          │                                      │────┐                                 │                                  │                                             │                                      │                      │   
                          │                                      │    │ 3. Extract MSISDN               │                                  │                                             │                                      │                      │   
                          │                                      │<───┘                                 │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │        4. Authenticate(MSISDN)       │                                  │                                             │                                      │                      │   
                          │                                      │ ─────────────────────────────────────>                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │         5. OK (Processing...)        │                                  │                                             │                                      │                      │   
                          │                                      │ <─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │ 6. Send(signed(challenge),MSISDN)│                                             │                                      │                      │   
                          │                                      │                                      │ ─────────────────────────────────>                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │ 7. Send(Encrypted(signed(challenge)),MSISDN)│                                      │                      │   
                          │                                      │                                      │                                  │ ────────────────────────────────────────────>                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │ 8. Send(Encrypted(signed(challenge)))│                      │   
                          │                                      │                                      │                                  │                                             │ ─────────────────────────────────────>                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │────┐                     
                          │                                      │                                      │                                  │                                             │                                      │    │ 9. Verify Request   
                          │                                      │                                      │                                  │                                             │                                      │<───┘                     
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │  10. Show Challenge  │   
                          │                                      │                                      │                                  │                                             │                                      │ ─────────────────────>   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │     11. Pin Code     │   
                          │                                      │                                      │                                  │                                             │                                      │ <─────────────────────   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │────┐                 │   
                          │                                      │                                      │                                  │                                             │                                      │    │ 12. Verify Pin  │   
                          │                                      │                                      │                                  │                                             │                                      │<───┘                 │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │       Send(Signed(Response OK))      │                      │   
                          │                                      │                                      │                                  │                                             │ <─────────────────────────────────────                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                               Signed(Response OK)                              │                                      │                      │   
                          │                                      │                                      │ <───────────────────────────────────────────────────────────────────────────────                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │────┐                             │                                             │                                      │                      │   
                          │                                      │                                      │    │ Verify Response             │                                             │                                      │                      │   
                          │                                      │                                      │<───┘                             │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │           Authentication OK          │                                  │                                             │                                      │                      │   
                          │                                      │ <─────────────────────────────────────                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │                  OK                  │                                  │                                             │                                      │                      │   
                          │                                      │  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ >                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │                                      │────┐                                                                    │                                             │                                      │                      │   
                          │                                      │    │ Generates(id_token, access_token)                                  │                                             │                                      │                      │   
                          │                                      │<───┘                                                                    │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
                          │ 9. POST https://client.example.com/cb│                                      │                                  │                                             │                                      │                      │   
                          │ <─────────────────────────────────────                                      │                                  │                                             │                                      │                      │   
                          │                                      │                                      │                                  │                                             │                                      │                      │   
      ╔═══════════════════╧══════════════════════════════════════╧═════════════════════╗                │                                  │                                             │                                      │                      │   
      ║POST /cb HTTP/1.1                                                               ║                │                                  │                                             │                                      │                      │   
      ║Host: client.example.com                                                        ║                │                                  │                                             │                                      │                      │   
      ║Content-Type: application/json                                                  ║                │                                  │                                             │                                      │                      │   
      ║{                                                                               ║                │                                  │                                             │                                      │                      │   
      ║ "grant_type="urn:openid:params:modrna:grant-type:backchannel_token_response",  ║                │                                  │                                             │                                      │                      │   
      ║ "client_req_id": "8d67dc78-7faa-4d41-aabd-67707b374255",                       ║                │                                  │                                             │                                      │                      │   
      ║ "auth_req_id": "1c266114-a1be-4252-8ad1-04986c5b9ac1",                         ║                │                                  │                                             │                                      │                      │   
      ║ "access_token": "SlAV32hkKG",                                                  ║                │                                  │                                             │                                      │                      │   
      ║ "token_type": "Bearer",                                                        ║                │                                  │                                             │                                      │                      │   
      ║ "refresh_token": "8xLOxBtZp8",                                                 ║                │                                  │                                             │                                      │                      │   
      ║ "expires_in": 3600,                                                            ║                │                                  │                                             │                                      │                      │   
      ║ "id_token": "eyJhbGciOiJSUzI1NiIsImtpZCI6IjFlOWdkazcifQ.ewogImlzc..."          ║                │                                  │                                             │                                      │                      │   
      ║}                                                                               ║                │                                  │                                             │                                      │                      │   
      ╚════════════════════════════════════════════════════════════════════════════════╝              ┌─┴──┐                             ┌─┴─┐                                         ┌─┴──┐                              ┌────┴─────┐               User 
                         │RP│                                   │OP│                                  │MSSP│                             │OTA│                                         │SMSC│                              │SIM Applet│                ┌─┐ 
                         └──┘                                   └──┘                                  └────┘                             └───┘                                         └────┘                              └──────────┘                ║"│ 
                                                                                                                                                                                                                                                       └┬┘ 
                                                                                                                                                                                                                                                       ┌┼┐ 
                                                                                                                                                                                                                                                        │  
                                                                                                                                                                                                                                                       ┌┴┐ 
